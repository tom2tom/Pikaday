/*!
 * Pikamonth - derived from Pikaday
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/dbushell/Pikamonth
 */
(function(a,b){"use strict";var d;if(typeof exports==="object"){try{d=require("moment")}catch(c){}module.exports=b(d)}else{if(typeof define==="function"&&define.amd){define(function(f){var h="moment";try{d=f(h)}catch(g){}return b(d)})}else{a.Pikamonth=b(a.moment)}}}(this,function(v){"use strict";var g=typeof v==="function",d=!!window.addEventListener,n=window.document,r=window.setTimeout,o=function(z,A,B,y){if(d){z.addEventListener(A,B,!!y)}else{z.attachEvent("on"+A,B)}},s=function(z,A,B,y){if(d){z.removeEventListener(A,B,!!y)}else{z.detachEvent("on"+A,B)}},x=function(z,y,A){var B;if(n.createEvent){B=n.createEvent("HTMLEvents");B.initEvent(y,true,false);B=u(B,A);z.dispatchEvent(B)}else{if(n.createEventObject){B=n.createEventObject();B=u(B,A);z.fireEvent("on"+y,B)}}},t=function(y){return y.trim?y.trim():y.replace(/^\s+|\s+$/g,"")},b=function(y,z){return(" "+y.className+" ").indexOf(" "+z+" ")!==-1},i=function(y,z){if(!b(y,z)){y.className=(y.className==="")?z:y.className+" "+z}},k=function(y,z){y.className=t((" "+y.className+" ").replace(" "+z+" "," "))},h=function(y){return(/Array/).test(Object.prototype.toString.call(y))},w=function(y){return(/Date/).test(Object.prototype.toString.call(y))&&!isNaN(y.getTime())},j=function(A){if(w(A)){var B=A.getFullYear(),z=A.getMonth();A.setFullYear(B,z)}},p=function(z,y){return z.getTime()===y.getTime()},u=function(C,B,y){var A,z;for(A in B){z=C[A]!==undefined;if(z&&typeof B[A]==="object"&&B[A]!==null&&B[A].nodeName===undefined){if(w(B[A])){if(y){C[A]=new Date(B[A].getTime())}}else{if(h(B[A])){if(y){C[A]=B[A].slice(0)}}else{C[A]=u({},B[A],y)}}}else{if(y||!z){C[A]=B[A]}}}return C},a=function(z,y){var A=v(z,y);return(A&&A.isValid())?A.toDate():null},f=function(z,y){return v(z).format(y)},defaults={field:null,bound:undefined,position:"bottom left",reposition:true,format:"YYYY-MM",abbr:true,defaultDate:null,setDefaultDate:false,minDate:null,maxDate:null,yearRange:10,minYear:0,maxYear:9999,isRTL:false,yearSuffix:"",container:undefined,i18n:{previousYear:"Previous Year",nextYear:"Next Year",months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},getdate:null,reformat:null,onSelect:null,onOpen:null,onClose:null,onDraw:null},m=function(z,D,F,C,B,G){var E=[],H,A;if(G){E.push("is-disabled")}if(B){E.push("is-today")}if(C){E.push("is-selected")}H=(E.length>0)?' class="'+E.join(" ")+'"':"";A=z.abbr?z.i18n.monthsShort[D]:z.i18n.months[D];return'<td data-month="'+D+'"'+H+'><button class="pika-button pika-text" data-pika-year="'+F+'" data-pika-month="'+D+'" data-pika-day="1">'+A+"</button></td>"},e=function(z,y){return"<tr>"+(y?z.reverse():z).join("")+"</tr>"},c=function(y){return"<tbody>"+y.join("")+"</tbody>"},q=function(G,F){var B,A,E,C,y=G._o,z=F===y.minYear,H=F===y.maxYear,D='<div class="pika-title">';C=y.i18n.previousYear;D+='<button class="pika-prev'+(z?" is-disabled":"")+'" type="button" title="'+C+'">'+C+"</button>";if(h(y.yearRange)){B=y.yearRange[0];A=y.yearRange[1]+1}else{B=F-y.yearRange;A=1+F+y.yearRange}for(E=[];B<A&&B<=y.maxYear;B++){if(B>=y.minYear){E.push('<option value="'+B+'"'+(B===F?" selected":"")+">"+(B)+"</option>")}}D+='<div class="pika-label"><select class="pika-select pika-select-year">'+E.join("")+"</select></div>";C=y.i18n.nextYear;D+='<button class="pika-next'+(H?" is-disabled":"")+'" type="button" title="'+C+'">'+C+"</button>";return D+"</div>"},l=function(y,z){return'<table class="pika-table">'+c(z)+"</table>"},Pikamonth=function(A){var y=this,B=y.config(A);y._onMouseDown=function(D){if(!y._v){return}D=D||window.event;var C=D.target||D.srcElement;if(!C){return}if(!b(C,"is-disabled")){if(b(C,"pika-button")&&!b(C,"is-empty")){y.setDate(new Date(C.getAttribute("data-pika-year"),C.getAttribute("data-pika-month"),C.getAttribute("data-pika-day")),false);if(B.bound){r(function(){y.hide();if(B.field){B.field.blur()}},100)}return}else{if(b(C,"pika-prev")){y.prevYear()}else{if(b(C,"pika-next")){y.nextYear()}}}}if(!b(C,"pika-select")){if(D.preventDefault){D.preventDefault()}else{D.returnValue=false;return false}}else{y._c=true}};y._onChange=function(D){D=D||window.event;var C=D.target||D.srcElement;if(!C){return}if(b(C,"pika-select-year")){y.gotoYear(C.value)}};y._onInputChange=function(D){var C;if(D.firedBy===y){return}if(typeof B.getdate==="function"){C=B.getdate.call(this,B.field.value,B.format)}else{C=new Date(Date.parse(B.field.value))}y.setDate(w(C)?C:null);if(!y._v){y.show()}};y._onInputFocus=function(){y.show()};y._onInputClick=function(){y.show()};y._onInputBlur=function(){var C=n.activeElement;do{if(b(C,"pika-single")){return}}while((C=C.parentNode));if(!y._c){y._b=r(function(){y.hide()},50)}y._c=false};y._onClick=function(D){D=D||window.event;var C=D.target||D.srcElement,E=C;if(!C){return}if(!d&&b(C,"pika-select")){if(!C.onchange){C.setAttribute("onchange","return;");o(C,"change",y._onChange)}}do{if(b(E,"pika-single")||E===B.trigger){return}}while((E=E.parentNode));if(y._v&&C!==B.trigger&&E!==B.trigger){y.hide()}};y.el=n.createElement("div");y.el.className="pika-single"+(B.isRTL?" is-rtl":"");o(y.el,"mousedown",y._onMouseDown,true);o(y.el,"change",y._onChange);if(B.field){if(B.container){B.container.appendChild(y.el)}else{if(B.bound){n.body.appendChild(y.el)}else{B.field.parentNode.insertBefore(y.el,B.field.nextSibling)}}o(B.field,"change",y._onInputChange);if(!B.defaultDate&&B.field.value){if(typeof B.getdate==="function"){B.defaultDate=B.getdate.call(this,B.field.value,B.format)}else{B.defaultDate=new Date(Date.parse(B.field.value))}B.setDefaultDate=B.defaultDate==true}}var z=B.defaultDate;if(w(z)){if(B.setDefaultDate){y.setDate(z,true)}else{y.gotoDate(z)}}else{y.gotoDate(new Date())}if(B.bound){this.hide();y.el.className+=" is-bound";o(B.trigger,"click",y._onInputClick);o(B.trigger,"focus",y._onInputFocus);o(B.trigger,"blur",y._onInputBlur)}else{this.show()}};Pikamonth.prototype={config:function(A){if(!this._o){this._o=u({},defaults,true)}var z=u(this._o.i18n,A.i18n,true),B=u(this._o,A,true);B.i18n=z;B.isRTL=!!B.isRTL;B.field=(B.field&&B.field.nodeName)?B.field:null;B.bound=!!(B.bound!==undefined?B.field&&B.bound:B.field);B.trigger=(B.trigger&&B.trigger.nodeName)?B.trigger:B.field;B.disableMonthFn=(typeof B.disableMonthFn)=="function"?B.disableMonthFn:null;var y=parseInt(B.numberOfYears,10)||1;B.numberOfYears=y>5?5:y;if(!w(B.minDate)){B.minDate=false}if(!w(B.maxDate)){B.maxDate=false}if((B.minDate&&B.maxDate)&&B.maxDate<B.minDate){B.maxDate=B.minDate=false}if(B.minDate){j(B.minDate);B.minYear=B.minDate.getFullYear()}if(B.maxDate){j(B.maxDate);B.maxYear=B.maxDate.getFullYear()}if(h(B.yearRange)){var C=new Date().getFullYear()-10;B.yearRange[0]=parseInt(B.yearRange[0],10)||C;B.yearRange[1]=parseInt(B.yearRange[1],10)||C}else{B.yearRange=Math.abs(parseInt(B.yearRange,10))||defaults.yearRange;if(B.yearRange>100){B.yearRange=100}}if(!B.getdate&&g){B.getdate=a}if(!B.reformat&&g){B.reformat=f}return B},toString:function(y){if(this._d&&w(this._d)){if(typeof this._o.reformat==="function"){return this._o.reformat.call(this,this._d,y||this._o.format)}else{return this._d.toDateString()}}return""},getMoment:function(){return null},setMoment:function(y,z){},getDate:function(){return w(this._d)?new Date(this._d.getTime()):null},setDate:function(A,F){if(!A){this._d=null;if(this._o.field){this._o.field.value="";if(this._o.field!=this._o.trigger){x(this._o.field,"change",{firedBy:this})}}this.draw();return}if(typeof A==="string"){A=new Date(Date.parse(A))}if(!w(A)){return}var D=this._o.minDate,G=this._o.maxDate;if(w(D)&&A<D){A=D}else{if(w(G)&&A>G){A=G}}var B=new Date(A.getTime());j(B);this.gotoDate(B);var z=this._o.field.value;if(z){var y;if(typeof this._o.getdate==="function"){y=this._o.getdate.call(this,z,this._o.format)}else{y=new Date(Date.parse(z))}if(w(y)){var C=y.getTime();j(y);var E=C-y.getTime();if(E){B.setTime(B.getTime()+E)}}}this._d=B;this._o.field.value=this.toString();if(this._o.field!=this._o.trigger){x(this._o.field,"change",{firedBy:this})}if(!F&&typeof this._o.onSelect==="function"){this._o.onSelect.call(this,this.getDate())}},gotoDate:function(y){if(!w(y)){return}this._year=y.getFullYear();this.draw()},gotoToday:function(){this.gotoDate(new Date())},gotoYear:function(z){var A=parseInt(z,10);if(!isNaN(A)){this._year=A;this.draw()}},nextYear:function(){if(!isNaN(this._year)){this._year++;this.draw()}},prevYear:function(){if(!isNaN(this._year)){this._year--;this.draw()}},setMinDate:function(y){this._o.minDate=y},setMaxDate:function(y){this._o.maxDate=y},draw:function(C){if(!this._v&&!C){return}var B=this._o,D=B.minYear,y=B.maxYear,A;if(!isNaN(D)&&this._y<=D){this._y=D}if(!isNaN(y)&&this._y>=y){this._y=y}A='<div class="pika-pikker">'+q(this,this._year)+this.render(this._year)+"</div>";this.el.innerHTML=A;if(B.bound){if(B.field.type!=="hidden"){r(function(){B.trigger.focus()},1)}}if(typeof this._o.onDraw==="function"){var z=this;r(function(){z._o.onDraw.call(z)},0)}},adjustPosition:function(){if(this._o.container){return}var G=this._o.trigger,E=G,z=this.el.offsetWidth,H=this.el.offsetHeight,D=window.innerWidth||n.documentElement.clientWidth,C=window.innerHeight||n.documentElement.clientHeight,A=window.pageYOffset||n.body.scrollTop||n.documentElement.scrollTop,B,F,y;if(typeof G.getBoundingClientRect==="function"){y=G.getBoundingClientRect();B=y.left+window.pageXOffset;F=y.bottom+window.pageYOffset}else{B=E.offsetLeft;F=E.offsetTop+E.offsetHeight;while((E=E.offsetParent)){B+=E.offsetLeft;F+=E.offsetTop}}if((this._o.reposition&&B+z>D)||(this._o.position.indexOf("right")>-1&&B-z+G.offsetWidth>0)){B=B-z+G.offsetWidth}if((this._o.reposition&&F+H>C+A)||(this._o.position.indexOf("top")>-1&&F-H-G.offsetHeight>0)){F=F-H-G.offsetHeight}this.el.style.cssText=["position: absolute","left: "+B+"px","top: "+F+"px"].join(";")},render:function(G){var y=this._o,C=new Date(),E=[],I=[],F;j(C);F=new Date(C.getTime());for(var D=0,z=0;D<12;D++){F.setFullYear(G,D);var B=w(this._d)?p(F,this._d):false,A=p(F,C),H=(y.minDate&&F<y.minDate)||(y.maxDate&&F>y.maxDate)||(y.disableMonthFn&&y.disableMonthFn(F));I.push(m(y,D,G,B,A,H));if(++z===3){E.push(e(I,y.isRTL));I=[];z=0}}return l(y,E)},isVisible:function(){return this._v},show:function(){if(!this._v){k(this.el,"is-hidden");this._v=true;this.draw();if(this._o.bound){o(n,"click",this._onClick);this.adjustPosition()}if(typeof this._o.onOpen==="function"){this._o.onOpen.call(this)}}},hide:function(){var y=this._v;if(y!==false){if(this._o.bound){s(n,"click",this._onClick)}this.el.style.cssText="";i(this.el,"is-hidden");this._v=false;if(y!==undefined&&y!==false&&typeof this._o.onClose==="function"){this._o.onClose.call(this)}}},destroy:function(){this.hide();s(this.el,"mousedown",this._onMouseDown,true);s(this.el,"change",this._onChange);if(this._o.field){s(this._o.field,"change",this._onInputChange);if(this._o.bound){s(this._o.trigger,"click",this._onInputClick);s(this._o.trigger,"focus",this._onInputFocus);s(this._o.trigger,"blur",this._onInputBlur)}}if(this.el.parentNode){this.el.parentNode.removeChild(this.el)}}};return Pikamonth}));